Code to calculate and plot faults and project faults to depth for immediate use in Coulomb 3.4.
Version 1.1
Written by Zoe Mildon, 2016
Updated in 2018
Code is free to use for research purposes, please cite the following paper:
Mildon, Z. K., S. Toda, J. P. Faure Walker, and G. P. Roberts (2016), Evaluating models of Coulomb stress transfer- is variable fault geometry important?, Geophys. Res. Lett., 43, doi:10.1002/2016GL071128.

INPUTS:
requires five individual text files with the following information (examples provided): 
	- list of fault names
      	- fault names with relevant dip
      	- fault names with relevant rake
      	- fault names with relevant projection direction
      	- for faults shorter than the depth of the seismogenic zone (which must be specified), a file with the names and lengths (rounded to nearest kilometre in the given example)

Requires the kml files from Google Earth for each fault to be saved individually in a single directory called "Fault_traces".

This code works using Universal Trans Mercator (UTM) coordinates.

All parameters should be edited in the 'faults_3D code'. Then run this code in Matlab by typing 'faults_3D' into the Command Window and the Coulomb input file will be built.  

BUILDING SLIP DISTRIBUTIONS
The code will build simple bulls eye slip distributions according to four different options (which are made as selections when the code is running).
The down-dip extent of the rupture can be controlled by changing the 'rupture_depth' variable.
For all options, the default is that the location of maximum slip is at the centre of the fault. However the location of maximum slip can be changed by altering the 'centre_vertical' and 'centre_horizontal' variables.
1. The whole fault slips. This assumes the slip is zero at the base, zero at the edges and a specified proportion of maximum slip reaches the surface. 
2. Only the central section of the fault slips, a length of rupture will be requested by the code. 
3. Only the north or west end of the fault slips, a length of rupture will be requested by the code. 
4. Only the south or east end of the fault slips, a length of rupture will be requested by the code. 

Alternatively, slip distributions can be manually assigned to each element in the Coulomb input file created from running this code.

OUTPUTS:
Writes a .inr file which can be used directly in Coulomb 3.4. HOWEVER BEFORE using in Coulomb, the #fixed value needs to be changed in the third line of the file. This file is created in the "Output_files" folder.

The code also calculates the total seismic moment released by the calculated slip distribution, and displays this in the Matlab Command Window. 

ASSUMPTIONS:
  	- the slip vector is preserved down dip
  	- the trace at the surface continues to depth
  	- the dip of the faults are consistent with depth (i.e. planar, not listric geometry)
  	- the slip distribution generated by this code creates a simple bulls eye slip distribution.

For further information, please see the published GRL paper.

Please report any issues or bugs to Zoe Mildon (zoe.mildon.13@ucl.ac.uk, zoe.mildon@plymouth.ac.uk).
