# faults_3D
Code to calculate and plot faults and project faults to depth for immediate use in Coulomb 3.4. 

Version 1.1 - Written by Zoe Mildon, 2016

Updated in 2018

Code is free to use for research purposes, please cite the following paper:
Mildon, Z. K., S. Toda, J. P. Faure Walker, and G. P. Roberts (2016), Evaluating models of Coulomb stress transfer- is variable fault geometry important?, Geophys. Res. Lett., 43, doi:10.1002/2016GL071128.

UPDATED VERSION:
Version 1.9 -  06/2021

# INPUTS:
Three input formats are supported:
1) A shapefile (in UTM coordinates) that contains all faults. It may contain more faults than to be modelled, faults can be selected within the workflow.
2) kml-files of all faults (stored in the 'Fault_traces' folder) AND a table (txt, csv, xlsx,...) that contains the properties of the faults
3) A kmz-file containing the fault traces and a table containing the fault properties

If kml or kmz import is chosen please specify the UTM zone and hemisphere in the user interface.
For shp-import, the file should be projected in UTM coordinates.

Required properties (either in the table or as attributes in the shape file) are:

fault_name - for kml import the name of the kml file must be the same as the fault_name
dip - dip angle
rake
dip_dir - dip direction (projection direction)

It is recommended to name the properties/attributes exactly as given, otherwise they have to be entered during execution. Example files for each input type are included in the 'input_examples' folder.
A depth column may be optionally given. In the 3D-plot, faults will reach to that specified depth (km).

Variable dip:

To model faults with variable dip, the depth intervals and respective dip values need to be specified in an extra table in the format of the given example (variable_dip_example.xlsx).
The table can be imported via the 'import variable dip' button on the 'Customisation' tab, fault names must exactly match faults in the table, otherwise they will not be detected and dip remains constant.

# RUNNING THE CODE
In MATLAB, navigate to the 'faults_3D_v1.9' folder (or similarly named). Execute the script by entering 'faults_3D' in the command line or open the faults_3D script and press F5.

# BUILDING SLIP DISTRIBUTIONS
The code will build simple bulls eye slip distributions according to two different options (which are made as selections when the code is running).
The down-dip extent of the rupture can be controlled by changing the 'rupture_depth' variable.
The default is that the location of maximum slip is at the centre of the fault. However the location of maximum slip can be changed by altering the 'centre_vertical' and 'centre_horizontal' variables.
1. The whole fault slips. This assumes the slip is zero at the base, zero at the edges and a specified proportion of maximum slip reaches the surface. 
2. A segment, which is specified by the user, slips. The segment is defined by two distances from one of the faults end (the 'start' point). As the start of the 
   fault is arbitrary, it is indicated with a black circle on the overview map. Make sure that the specified horizontal center of the slip distribution is within
   the specified segment.

Alternatively, slip distributions can be manually assigned to each element in the Coulomb input file created from running this code.

# OUTPUTS:
Writes a .inr file which can be used directly in Coulomb 3.4. HOWEVER BEFORE using in Coulomb, the #fixed value needs to be changed in the third line of the file. This file is created in the "Output_files" folder.

The code also calculates the total seismic moment released by the calculated slip distribution, and displays this in the Matlab Command Window. 

# ASSUMPTIONS:
  - the slip vector is preserved down dip
  - the trace at the surface continues to depth
  - the dip of the faults are consistent with depth (i.e. planar, not listric geometry)
  - the slip distribution generated by this code creates a simple bulls eye slip distribution.

For further information, please see the published GRL paper.

Please report any issues or bugs to Zoe Mildon (zoe.mildon.13@ucl.ac.uk, zoe.mildon@plymouth.ac.uk).

# REFERENCES:
This code uses the following functions:

kml2struct_multi version 1.2.1 by Reno Filla (https://uk.mathworks.com/matlabcentral/fileexchange/80083-kml2struct_multi)

kmz2struct version 1.0.0 by Nathan Ellingson (https://uk.mathworks.com/matlabcentral/fileexchange/70450-kmz2struct)

wgs2utm version 1.2.0.0 by Alexandre Schimel (https://uk.mathworks.com/matlabcentral/fileexchange/14804-wgs2utm-version-2)

MATLAB mapping toolbox is required.

